<!DOCTYPE html>
<html lang="es">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Gestionar aplicaciones - My Store</title>
Â  <link rel="stylesheet" href="styles-admin.css" />
Â  
Â  Â  <style>
Â  Â  /* 1. Estilos para la CuadrÃ­cula Compacta */
Â  Â  .apps-grid {
Â  Â  Â  display: grid;
Â  Â  Â  /* Usamos un tamaÃ±o mÃ¡s pequeÃ±o (minmax(200px)) para que quepan mÃ¡s */
Â  Â  Â  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
Â  Â  Â  gap: 1.5rem;
Â  Â  Â  margin-top: 2rem;
Â  Â  }

Â  Â  /* Estilos de la tarjeta de aplicaciÃ³n */
Â  Â  .app-card {
Â  Â  Â  background: white;
Â  Â  Â  border-radius: 1rem;
Â  Â  Â  padding: 1rem;
Â  Â  Â  width: 100%; /* Asegura que ocupe el espacio de la cuadrÃ­cula */
Â  Â  Â  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
Â  Â  Â  transition: transform 0.2s ease, box-shadow 0.2s ease;
Â  Â  Â  position: relative;
Â  Â  }

Â  Â  .app-card:hover {
Â  Â  Â  transform: translateY(-5px);
Â  Â  Â  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
Â  Â  }

Â  Â  .app-card img {
Â  Â  Â  width: 100%;
Â  Â  Â  /* Reducimos la altura de la imagen para hacerla mÃ¡s compacta */
Â  Â  Â  height: 120px;
Â  Â  Â  object-fit: cover;
Â  Â  Â  border-radius: 0.8rem;
Â  Â  Â  margin-bottom: 0.8rem;
Â  Â  }

Â  Â  .app-card h3 {
Â  Â  Â  color: #007bff;
Â  Â  Â  margin-bottom: 0.4rem;
Â  Â  Â  /* Asegura que el tÃ­tulo largo no rompa la tarjeta */
Â  Â  Â  white-space: nowrap;
Â  Â  Â  overflow: hidden;
Â  Â  Â  text-overflow: ellipsis;
Â  Â  }

Â  Â  .app-card p {
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  color: #555;
Â  Â  Â  margin-bottom: 0.8rem;
Â  Â  Â  /* Limita la descripciÃ³n a 2 lÃ­neas */
Â  Â  Â  display: -webkit-box;
Â  Â  Â  -webkit-line-clamp: 2;
Â  Â  Â  -webkit-box-orient: vertical;
Â  Â  Â  overflow: hidden;
Â  Â  }

Â  Â  .delete-btn {
Â  Â  Â  background: #ff4757;
Â  Â  Â  border: none;
Â  Â  Â  color: white;
Â  Â  Â  padding: 0.4rem 0.8rem;
Â  Â  Â  border-radius: 0.4rem;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background 0.3s ease;
Â  Â  }

Â  Â  .delete-btn:hover {
Â  Â  Â  background: #e84118;
Â  Â  }

Â  Â  /* 2. Estilos de la Cabecera (Para mantener el botÃ³n "Volver al Panel" ahÃ­) */
Â  Â  
Â  Â  /* Asegura que la cabecera alinee el logo a un lado y los botones al otro */
Â  Â  header {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  Â  padding: 1rem 0; /* Ajusta el relleno si es necesario */
Â  Â  }

Â  Â  .logo-section {
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 10px;
Â  Â  }
Â  Â  
Â  Â  .header-logo {
Â  Â  Â  /* Ajusta el tamaÃ±o de tu logo si es necesario */
Â  Â  Â  height: 40px; 
Â  Â  }

Â  Â  .header-buttons {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 10px; /* Espacio entre botones */
Â  Â  Â  align-items: center;
Â  S }

Â  Â  /* Estilo para el botÃ³n de la cabecera "Volver al Panel" */
Â  Â  .back-to-panel-btn {
Â  Â  Â  background: #007bff; /* Color azul */
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  Â  padding: 0.6rem 1rem;
Â  Â  Â  border-radius: 0.5rem;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background 0.3s ease;
Â  Â  Â  font-size: 0.9rem; /* Asegura tamaÃ±o de fuente consistente */
Â  Â  }

Â  Â  .back-to-panel-btn:hover {
Â  Â  Â  background: #0056b3;
Â  S }
Â  Â  
Â  Â  .logout-btn {
Â  Â  Â  /* Estilos del botÃ³n rojo "Cerrar sesiÃ³n" */
Â  Â  Â  background: #ff4757;
Â  Â  Â  border: none;
Â  Â  Â  color: white;
Â  Â  Â  padding: 0.6rem 1rem;
Â  Â  Â  border-radius: 0.5rem;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background 0.3s ease;
Â  Â  Â  font-size: 0.9rem; /* Asegura tamaÃ±o de fuente consistente */
Â  Â  }
Â  Â  
Â  Â  .logout-btn:hover {
Â  Â  Â  background: #e84118;
Â  Â  }
Â  </style>
Â  </head>

<body>
Â  <div class="admin-panel">
Â  Â  Â  Â  <header>
Â  Â  Â  <div class="logo-section">
Â  Â  Â  Â  <img src="logo.png" alt="My Store Logo" class="header-logo" />
Â  Â  Â  Â  <h1>Gestionar Aplicaciones</h1>
Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="header-buttons">
Â  Â  Â  Â  <button class="back-to-panel-btn" onclick="goBack()">â† Volver al Panel</button>
Â  Â  Â  Â  <button class="logout-btn" onclick="logout()">Cerrar sesiÃ³n</button>
Â  Â  Â  </div>
Â  Â  </header>
Â  Â  Â  Â  <section>
Â  Â  Â  <h2>ğŸ“‹ Aplicaciones publicadas</h2>
Â  Â  Â  
Â  Â  Â  Â  Â  Â  <div id="appsContainer" class="apps-grid">Cargando apps...</div> 
Â  Â  Â  
Â  Â  Â  Â  Â  </section>
Â  </div>

Â  Â  <script>
Â  Â  async function loadApps() {
Â  Â  Â  try {
Â  Â  Â  Â  const res = await fetch("/api/apps");
Â  Â  Â  Â  const apps = await res.json();
Â  Â  Â  Â  const container = document.getElementById("appsContainer");
Â  Â  Â  Â  container.innerHTML = "";

Â  Â  Â  Â  if (apps.length === 0) {
Â  S Â  Â  Â  Â  container.innerHTML = "<p>No hay aplicaciones publicadas todavÃ­a.</p>";
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  apps.forEach((app) => {
Â  Â  Â  Â  Â  const card = document.createElement("div");
Â  Â  Â  Â  Â  // Â¡IMPORTANTE! Se aÃ±ade la clase 'app-card'
Â  Â  Â  Â  Â  card.classList.add("app-card"); 
Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  <img src="/uploads/${app.image}" alt="${app.name}" />
Â  Â  Â  Â  Â  Â  <h3>${app.name}</h3>
Â  Â  Â  Â  Â  Â  <p>${app.description}</p>
Â  Â  Â  Â  Â  Â  <button class="delete-btn" onclick="deleteApp(${app.id})">ğŸ—‘ï¸ Eliminar</button>
Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  container.appendChild(card);
Â  Â  Â  Â  });
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Error cargando apps:", error);
Â  Â  Â  }
Â  Â  }

Â  Â  async function deleteApp(id) {
Â  Â  Â  if (!confirm("Â¿Seguro que quieres eliminar esta aplicaciÃ³n?")) return;
Â  Â  Â  try {
Â  Â  Â  Â  const res = await fetch(`/apps/${id}`, { method: "DELETE" });
Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  alert(data.message);
Â  Â  Â  Â  loadApps();
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  alert("Error al eliminar la aplicaciÃ³n.");
Â  Â  Â  }
Â  Â  }

Â  Â  function goBack() {
Â  Â  Â  window.location.href = "admin.html";
Â  Â  }

Â  Â  function logout() {
Â  Â  Â  if (confirm("Â¿Deseas cerrar sesiÃ³n?")) {
Â  Â  Â  Â  fetch("/logout", { method: "POST" })
Â  Â  Â  Â  Â  .then(() => (window.location.href = "/login.html"))
Â  Â  Â  Â  Â  .catch(() => alert("Error al cerrar sesiÃ³n."));
Â  Â  Â  }
Â  Â  }

Â  Â  // Cargar automÃ¡ticamente las apps al entrar
Â  Â  window.addEventListener("load", loadApps);
Â  </script>
Â  </body>
</html>
